#!/bin/sh

function generate() {
  eval $'cat <<\002\n'"$(tr -d '\002' < "/etc/supervisor.d/generator.ini.example")"$'\n\002' > "/etc/supervisor.d/$1.ini"
}

while getopts n:d:u:c: option
do
  case "${option}" in
    n) APPNAME=${OPTARG};;
    d) APPDIR=${OPTARG};;
    u) APPUSER=${OPTARG};;
    c) APPCMD=${OPTARG};;
  esac
done

if test -z "$APPNAME"; then
  echo "Nom de l'application requis !"
  exit
fi

if test -z "$APPCMD"; then
  echo "La commande d'éxécution est requise !"
  exit
fi

if test -z "$APPDIR"; then
  APPDIR="/app"
fi

if test -z "$APPUSER"; then
  APPUSER="root"
fi

generate ${APPNAME}
